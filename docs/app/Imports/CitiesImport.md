# CitiesImport

Импорт данных о городах из CSV-файла. Создаёт новые регионы и города, используя пакетную обработку.

#### Использует:

[City](/app/Models/Cities/City.md), [Region](/app/Models/Cities/Region.md)

#### Свойства

* `regionsCache` — коллекция существующих регионов с ключом по имени и значением `id`, используется для быстрого сопоставления города с регионом.

#### Методы

##### collection

```php
public function collection(Collection $rows)
```

Обрабатывает строки CSV-файла. Находит новые регионы, которых ещё нет в базе, и добавляет их. Обновляет кэш регионов. Формирует массив городов с привязкой к региону и вставляет их в таблицу `cities`.

Вход: коллекция строк CSV (`Collection`)

Выход: –

##### chunkSize

```php
public function chunkSize(): int
```

Возвращает размер пакета для обработки строк CSV.

Выход: число строк.

