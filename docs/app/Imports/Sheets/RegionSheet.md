# RegionSheet

Обработка листа с регионами из Excel.
Импортирует новые регионы, проверяя уникальность по имени.

#### Использует:

[Region](/app/Models/Cities/Region.md)

#### Свойства

* `regions` — коллекция всех регионов, с ключами по имени для быстрого поиска.

#### Методы

##### collection

```php
public function collection(Collection $rows)
```

Обрабатывает строки листа Excel.
Фильтрует только те строки, где есть название региона и оно ещё отсутствует в базе. Формирует массив для вставки и сохраняет новые регионы в таблицу `regions`.

Вход: коллекция строк из Excel (`Collection`)

Выход: –


##### chunkSize

```php
public function chunkSize(): int
```

Возвращает размер чанка для пакетной обработки строк Excel.

Выход: число строк в excel за раз

#### Примечания

* Название столбца определяется переводом `trans('main.cities.region')`, приведенным к slug-формату.
